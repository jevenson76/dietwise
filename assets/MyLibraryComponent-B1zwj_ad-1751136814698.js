import{f as Re,t as k,h as Be,j as e,S as me,F as ue,d as D,M as J,a as G,A as Ue,b as qe}from"./index-BI-eZDQS-1751136814698.js";import{r as l}from"./stripe-vendor-DyxxnUpE-1751136814698.js";import"./react-vendor-DV_4xMyD-1751136814698.js";import"./pdf-vendor-C2CeqvIt-1751136814698.js";import"./ai-vendor-D-53sdHu-1751136814698.js";import"./scanner-vendor-UkOZGUfT-1751136814698.js";import"./date-vendor-B5WjnTJ1-1751136814698.js";import"./chart-vendor-DB0wJBOF-1751136814698.js";const W="myfood-barcode-video",He=({sizeLabel:o="Banner Ad (e.g., 320x50)",className:f=""})=>e.jsxs("div",{className:`bg-slate-200 dark:bg-slate-700 border-2 border-dashed border-slate-400 dark:border-slate-500 text-slate-500 dark:text-slate-400 text-sm flex flex-col items-center justify-center h-20 sm:h-24 my-6 rounded-md shadow text-center p-2 ${f}`,children:[e.jsx("i",{className:"fas fa-ad text-2xl text-slate-400 dark:text-slate-500 mb-1"}),e.jsx("p",{className:"font-semibold",children:"Advertisement"}),e.jsx("p",{className:"text-xs",children:o})]}),et=({myFoods:o,myMeals:f,onAddFood:ge,onUpdateFood:fe,onDeleteFood:he,onAddMeal:be,onUpdateMeal:pe,onDeleteMeal:ve,onLogMeal:je,apiKeyMissing:R,userName:w,targetCalories:X})=>{const[ye,N]=l.useState(!1),[Ne,B]=l.useState(!1),[C,Z]=l.useState(null),[U,K]=l.useState(null),[n,g]=l.useState({}),[i,p]=l.useState({ingredients:[]}),[M,d]=l.useState(null),[Se,q]=l.useState(!1),[I,b]=l.useState(null),[$,A]=l.useState(!1),[H,ee]=l.useState(null),[te,T]=l.useState([]),[j,E]=l.useState(""),[y,L]=l.useState(""),[x,_]=l.useState([]),[m,z]=l.useState([]),[se,Ce]=l.useState(!1),[ae,Fe]=l.useState(!1),ke=l.useCallback(t=>{ee(t),A(!0),b(null),T([]),Re(t).then(s=>{if(s.foodInfo&&s.foodInfo.name?(g({name:s.foodInfo.name,calories:s.foodInfo.calories,servingSize:s.foodInfo.servingSize,protein:s.foodInfo.protein,carbs:s.foodInfo.carbs,fat:s.foodInfo.fat}),k("myfood_upc_food_info_retrieved",{foodName:s.foodInfo.name}),q(!1),N(!0)):(b(s.error||"Could not retrieve food information for this UPC."),k("myfood_upc_food_info_error",{error:s.error})),s.sources){const r=s.sources.filter(a=>a.web!==void 0).map(a=>({web:a.web}));T(r)}}).catch(s=>{b(s.message||"An unexpected error occurred."),k("myfood_upc_food_info_exception",{error:s.message})}).finally(()=>A(!1))},[]),we=l.useCallback(t=>{b(`Scanner Error: ${t.message}. Please ensure camera access is allowed.`),k("myfood_upc_scan_error_hook",{error:t.message}),A(!1),re()},[]),{startScan:Me,stopScan:re,isScanning:Q,error:V,videoRef:le}=Be({onScanSuccess:ke,onScanError:we,videoElementId:W});l.useEffect(()=>{V&&b(`Scanner Init Error: ${V}. Check camera permissions.`)},[V]);const Ie=()=>{R||(N(!1),q(!0),b(null),ee(null),A(!1),T([]),g({}),setTimeout(()=>{const t=document.getElementById(W);le.current&&t&&t.isConnected?Me().catch(s=>{b(`Failed to start camera: ${s.message}.`),k("myfood_scanner_start_failed",{error:s.message})}):b("Camera element not ready for MyFood scanner.")},100))},ne=()=>{re(),q(!1),N(!0)},h="mt-1 block w-full px-4 py-2.5 border border-border-default rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 sm:text-sm placeholder-slate-400 bg-bg-card text-text-default dark:placeholder-slate-500",v="bg-teal-500 hover:bg-teal-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-colors disabled:opacity-50",$e="bg-red-500 hover:bg-red-600 text-white font-semibold py-1.5 px-3 rounded text-xs shadow",S=(t=null)=>{Z(t),g(t?{...t}:{name:"",calories:void 0}),d(null),N(!0)},Ae=()=>{var t;if(d(null),!((t=n.name)!=null&&t.trim())){d("Food name is required.");return}if(n.calories===void 0||n.calories===null||isNaN(n.calories)||n.calories<=0){d("Valid calories (must be a positive number) are required.");return}C?fe(n):ge(n),N(!1),g({})},O=(t=null)=>{K(t),p(t?{...t,ingredients:t.ingredients?[...t.ingredients]:[]}:{name:"",description:"",ingredients:[]}),d(null),B(!0)},Ee=()=>{var t;if(d(null),!((t=i.name)!=null&&t.trim())){d("Meal name is required.");return}if(!i.ingredients||i.ingredients.length===0){d("A meal must have at least one ingredient.");return}if(i.ingredients.some(s=>!s.foodId||s.servings<=0)){d("All ingredients must be selected and have a valid serving size (>0).");return}U?pe(i):be(i),B(!1),p({ingredients:[]})},oe=(t,s,r)=>{const a=[...i.ingredients||[]];s==="servings"?a[t]={...a[t],[s]:parseFloat(r)||1}:a[t]={...a[t],[s]:r},p(u=>({...u,ingredients:a}))},Le=()=>{p(t=>({...t,ingredients:[...t.ingredients||[],{foodId:"",servings:1}]}))},_e=t=>{p(s=>({...s,ingredients:(s.ingredients||[]).filter((r,a)=>a!==t)}))},ie=[{id:"calories",label:"Calories",type:"range",min:0,max:1e3,step:10,unit:" kcal"},{id:"protein",label:"Protein",type:"range",min:0,max:100,step:1,unit:"g"},{id:"hasServingSize",label:"Has Serving Size",type:"toggle"},{id:"hasMacros",label:"Has Macros Info",type:"toggle"}],de=[{id:"totalCalories",label:"Total Calories",type:"range",min:0,max:2e3,step:50,unit:" kcal"},{id:"ingredientCount",label:"Number of Ingredients",type:"range",min:1,max:20,step:1,unit:""},{id:"hasDescription",label:"Has Description",type:"toggle"}],P=o.filter(t=>{if(j&&!t.name.toLowerCase().includes(j.toLowerCase()))return!1;for(const s of x)switch(s.groupId){case"calories":if(t.calories<s.value[0]||t.calories>s.value[1])return!1;break;case"protein":if(!t.protein||t.protein<s.value[0]||t.protein>s.value[1])return!1;break;case"hasServingSize":if(s.value&&!t.servingSize)return!1;break;case"hasMacros":if(s.value&&(!t.protein||!t.carbs||!t.fat))return!1;break}return!0}),Y=f.filter(t=>{var s;if(y&&!t.name.toLowerCase().includes(y.toLowerCase()))return!1;for(const r of m)switch(r.groupId){case"totalCalories":const a=t.totalCalories||0;if(a<r.value[0]||a>r.value[1])return!1;break;case"ingredientCount":const u=((s=t.ingredients)==null?void 0:s.length)||0;if(u<r.value[0]||u>r.value[1])return!1;break;case"hasDescription":if(r.value&&!t.description)return!1;break}return!0}),ze=(t,s)=>{const r=x.findIndex(c=>c.groupId===t),a=ie.find(c=>c.id===t);if(!a)return;let u="";a.type==="range"?u=`${a.label}: ${s[0]}${a.unit||""} - ${s[1]}${a.unit||""}`:a.type==="toggle"&&(u=`${a.label}: ${s?"Yes":"No"}`);const F={groupId:t,value:s,label:u};if(r>=0){const c=[...x];c[r]=F,_(c)}else _([...x,F])},Oe=(t,s)=>{const r=m.findIndex(c=>c.groupId===t),a=de.find(c=>c.id===t);if(!a)return;let u="";a.type==="range"?u=`${a.label}: ${s[0]}${a.unit||""} - ${s[1]}${a.unit||""}`:a.type==="toggle"&&(u=`${a.label}: ${s?"Yes":"No"}`);const F={groupId:t,value:s,label:u};if(r>=0){const c=[...m];c[r]=F,z(c)}else z([...m,F])},ce=()=>_([]),xe=()=>z([]),Pe=t=>{_(x.filter(s=>s.groupId!==t))},Ye=t=>{z(m.filter(s=>s.groupId!==t))},De=o.map(t=>t.name).filter(t=>t.toLowerCase().includes(j.toLowerCase())).slice(0,5),Ge=f.map(t=>t.name).filter(t=>t.toLowerCase().includes(y.toLowerCase())).slice(0,5);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-bg-card p-6 sm:p-8 rounded-xl shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 pb-3 border-b border-border-default",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-semibold text-text-default",children:[e.jsx("i",{className:"fas fa-carrot mr-2.5 text-orange-500 dark:text-orange-400"}),"My Foods"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>Ce(!se),className:`${v} ${x.length>0?"bg-teal-600":"bg-gray-500 hover:bg-gray-600"} relative`,children:[e.jsx("i",{className:"fas fa-filter mr-1.5"}),"Filter",x.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-orange-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center",children:x.length})]}),e.jsxs("button",{onClick:()=>S(),className:v,children:[e.jsx("i",{className:"fas fa-plus mr-1.5"}),"Add Food"]})]})]}),e.jsxs("div",{className:"mb-4 space-y-4",children:[e.jsx(me,{value:j,onChange:E,onClear:()=>E(""),placeholder:"Search your foods...",suggestions:De,onSuggestionSelect:E,icon:"fas fa-search",variant:"default",size:"md"}),se&&e.jsx(ue,{filterGroups:ie,activeFilters:x,onFilterChange:ze,onClearFilters:ce,onClearFilter:Pe,variant:"inline",showActiveCount:!0})]}),e.jsxs("p",{className:"text-sm text-text-alt mb-4",children:[w?`${w}, save your favorite foods here for quick logging.`:"Save your favorite foods here for quick logging.",X&&` Remember, your daily goal is ${X.toLocaleString()} calories.`,P.length!==o.length&&e.jsxs("span",{className:"block mt-1 text-teal-600 dark:text-teal-400",children:["Showing ",P.length," of ",o.length," foods"]})]}),o.length===0?e.jsx(D,{icon:"fas fa-apple-alt",iconColor:"text-orange-500 dark:text-orange-400",title:"Build Your Food Library",description:"Save your favorite foods for quick and easy logging.",actionLabel:"Add Your First Food",onAction:()=>S(),tips:["Add foods you eat regularly for faster tracking","Include serving sizes for accurate portions","Add macros (protein, carbs, fat) for better insights"]}):P.length===0?e.jsx(D,{icon:"fas fa-search",iconColor:"text-gray-500 dark:text-gray-400",title:"No Foods Found",description:j||x.length>0?"No foods match your search criteria. Try adjusting your filters or search terms.":"You don't have any foods saved yet.",actionLabel:j||x.length>0?"Clear Filters":"Add Your First Food",onAction:j||x.length>0?()=>{E(""),ce()}:()=>S(),tips:["Use the search bar to find foods by name","Apply filters to narrow down by calories or macros","Clear filters to see all your saved foods"]}):e.jsx("ul",{className:"space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2",children:P.map(t=>e.jsxs("li",{className:"p-4 border border-border-default rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-text-default",children:t.name}),e.jsxs("p",{className:"text-xs text-text-alt",children:[t.calories," kcal",t.servingSize?` / ${t.servingSize}`:""]}),(t.protein||t.carbs||t.fat)&&e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[t.protein?`P: ${t.protein}g `:"",t.carbs?`C: ${t.carbs}g `:"",t.fat?`F: ${t.fat}g`:""]})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:()=>S(t),className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 p-1","aria-label":`Edit ${t.name}`,children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{onClick:()=>he(t.id),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 p-1","aria-label":`Delete ${t.name}`,children:e.jsx("i",{className:"fas fa-trash"})})]})]},t.id))})]}),e.jsxs("div",{className:"bg-bg-card p-6 sm:p-8 rounded-xl shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 pb-3 border-b border-border-default",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-semibold text-text-default",children:[e.jsx("i",{className:"fas fa-utensils mr-2.5 text-purple-500 dark:text-purple-400"}),"My Meals"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>Fe(!ae),className:`${v} ${m.length>0?"bg-teal-600":"bg-gray-500 hover:bg-gray-600"} relative`,children:[e.jsx("i",{className:"fas fa-filter mr-1.5"}),"Filter",m.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-orange-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center",children:m.length})]}),e.jsxs("button",{onClick:()=>O(),className:v,children:[e.jsx("i",{className:"fas fa-plus mr-1.5"}),"Create Meal"]})]})]}),e.jsxs("div",{className:"mb-4 space-y-4",children:[e.jsx(me,{value:y,onChange:L,onClear:()=>L(""),placeholder:"Search your meals...",suggestions:Ge,onSuggestionSelect:L,icon:"fas fa-search",variant:"default",size:"md"}),ae&&e.jsx(ue,{filterGroups:de,activeFilters:m,onFilterChange:Oe,onClearFilters:xe,onClearFilter:Ye,variant:"inline",showActiveCount:!0})]}),e.jsxs("p",{className:"text-sm text-text-alt mb-4",children:[w?`${w}, create meal combinations for faster tracking.`:"Create meal combinations for faster tracking.",f.length>0&&` You have ${f.length} meal${f.length===1?"":"s"} saved.`,Y.length!==f.length&&e.jsxs("span",{className:"block mt-1 text-purple-600 dark:text-purple-400",children:["Showing ",Y.length," of ",f.length," meals"]})]}),f.length===0?e.jsx(D,{icon:"fas fa-utensils",iconColor:"text-purple-500 dark:text-purple-400",title:"Create Your First Meal",description:"Combine foods into meals for one-click logging of your favorite dishes.",actionLabel:o.length>0?"Create Meal":"Add Foods First",onAction:o.length>0?()=>O():()=>S(),secondaryActionLabel:o.length===0?"Learn More":void 0,onSecondaryAction:o.length===0?()=>alert("Add individual foods first, then combine them into meals!"):void 0,tips:[o.length===0?"You need to add foods before creating meals":"Group foods you often eat together","Perfect for meal prep or regular recipes","Meals calculate total nutrition automatically"]}):Y.length===0?e.jsx(D,{icon:"fas fa-search",iconColor:"text-gray-500 dark:text-gray-400",title:"No Meals Found",description:y||m.length>0?"No meals match your search criteria. Try adjusting your filters or search terms.":"You don't have any meals saved yet.",actionLabel:y||m.length>0?"Clear Filters":"Create Your First Meal",onAction:y||m.length>0?()=>{L(""),xe()}:o.length>0?()=>O():()=>S(),tips:["Use the search bar to find meals by name","Apply filters to narrow down by calories or ingredients","Clear filters to see all your saved meals"]}):e.jsx("ul",{className:"space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2",children:Y.map(t=>{var s;return e.jsxs("li",{className:"p-4 border border-border-default rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-text-default",children:t.name}),e.jsxs("p",{className:"text-xs text-text-alt",children:[((s=t.totalCalories)==null?void 0:s.toFixed(0))||0," kcal. ",t.ingredients.length," ingredient",t.ingredients.length===1?"":"s","."]}),t.description&&e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 italic",children:['"',t.description,'"']})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsxs("button",{onClick:()=>je(t.id),className:`${v} text-xs py-1 px-2.5 bg-green-500 hover:bg-green-600`,"aria-label":`Log ${t.name}`,children:[e.jsx("i",{className:"fas fa-plus-circle mr-1"}),"Log"]}),e.jsx("button",{onClick:()=>O(t),className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 p-1","aria-label":`Edit ${t.name}`,children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{onClick:()=>ve(t.id),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 p-1","aria-label":`Delete ${t.name}`,children:e.jsx("i",{className:"fas fa-trash"})})]})]},t.id)})})]}),e.jsx(He,{sizeLabel:"Food Library Ad (e.g., 300x100)",className:"mt-6"}),e.jsxs(J,{isOpen:ye,onClose:()=>{N(!1),Z(null),g({}),d(null)},title:C?"Edit Food":"Add New Food",children:[M&&e.jsx(G,{type:"error",message:M,onClose:()=>d(null),className:"mb-3"}),e.jsxs("div",{className:"space-y-4",children:[!C&&e.jsxs("button",{onClick:Ie,disabled:R,className:`${v} w-full bg-gradient-to-r from-sky-500 to-cyan-500 hover:from-sky-600 hover:to-cyan-600 text-white font-semibold py-2.5 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 transition-all mb-3 disabled:opacity-60 disabled:cursor-not-allowed`,children:[e.jsx("i",{className:"fas fa-barcode mr-2"}),"Scan Barcode to Pre-fill"]}),R&&!C&&e.jsx(G,{type:"warning",message:e.jsxs(e.Fragment,{children:[Ue," ",e.jsx("br",{})," Barcode scanning is disabled."]}),className:"mb-2 text-xs"}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"foodName",className:"block text-sm font-medium text-text-alt",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"foodName",value:n.name||"",onChange:t=>g(s=>({...s,name:t.target.value})),className:h,maxLength:100})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"foodCalories",className:"block text-sm font-medium text-text-alt",children:["Calories (kcal) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",id:"foodCalories",value:n.calories===void 0?"":n.calories,onChange:t=>g(s=>({...s,calories:t.target.value===""?void 0:parseFloat(t.target.value)})),className:h,min:"0",step:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"foodServingSize",className:"block text-sm font-medium text-text-alt",children:"Serving Size (e.g., 100g, 1 cup)"}),e.jsx("input",{type:"text",id:"foodServingSize",value:n.servingSize||"",onChange:t=>g(s=>({...s,servingSize:t.target.value})),className:h,maxLength:50})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"foodProtein",className:"text-xs text-text-alt",children:"Protein (g)"}),e.jsx("input",{type:"number",id:"foodProtein",value:n.protein===void 0?"":n.protein,onChange:t=>g(s=>({...s,protein:t.target.value===""?void 0:parseFloat(t.target.value)})),className:h,min:"0",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"foodCarbs",className:"text-xs text-text-alt",children:"Carbs (g)"}),e.jsx("input",{type:"number",id:"foodCarbs",value:n.carbs===void 0?"":n.carbs,onChange:t=>g(s=>({...s,carbs:t.target.value===""?void 0:parseFloat(t.target.value)})),className:h,min:"0",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"foodFat",className:"text-xs text-text-alt",children:"Fat (g)"}),e.jsx("input",{type:"number",id:"foodFat",value:n.fat===void 0?"":n.fat,onChange:t=>g(s=>({...s,fat:t.target.value===""?void 0:parseFloat(t.target.value)})),className:h,min:"0",step:"0.1"})]})]}),e.jsx("button",{onClick:Ae,className:v+" w-full",children:C?"Save Changes":"Add Food"})]})]}),e.jsx(J,{isOpen:Se,onClose:ne,title:"Scan Barcode for My Food",size:"xl",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"w-full max-w-md aspect-[4/3] bg-slate-200 dark:bg-slate-700 rounded-lg overflow-hidden mb-4 shadow-inner relative",children:[e.jsx("video",{id:W,ref:le,className:`w-full h-full object-cover ${Q||$||H?"":"hidden"}`,playsInline:!0}),!(Q||$||H||I)&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-slate-500 dark:text-slate-400 p-4",children:[e.jsx("i",{className:"fas fa-camera text-5xl mb-3 text-slate-400 dark:text-slate-500"}),e.jsx("p",{className:"text-center text-sm",children:"Initializing camera..."}),e.jsx("p",{className:"text-center text-xs mt-1",children:"Point at a barcode to scan."})]}),Q&&!$&&!I&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-white bg-black bg-opacity-30 p-4",children:[e.jsx("i",{className:"fas fa-barcode text-5xl mb-3 animate-pulse"}),e.jsx("p",{className:"text-center text-sm font-semibold",children:"Scanning..."})]})]}),I&&e.jsx(G,{type:"error",message:I,onClose:()=>b(null),className:"w-full max-w-md"}),$&&e.jsx("div",{className:"my-4 w-full max-w-md",children:e.jsx(qe,{message:"Looking up product information",submessage:`UPC: ${H}`,estimatedTime:5,tips:["Searching nutritional databases...","Cross-referencing product information...","Verifying nutritional data..."],size:"sm"})}),te.length>0&&e.jsxs("div",{className:"mt-4 p-3 bg-sky-50 dark:bg-sky-800/50 border border-sky-200 dark:border-sky-700 rounded-lg w-full max-w-md text-xs",children:[e.jsx("h4",{className:"text-xs font-semibold text-sky-700 dark:text-sky-300 mb-1",children:"Data Sources (from Google Search):"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:te.map((t,s)=>t.web.uri?e.jsx("li",{children:e.jsx("a",{href:t.web.uri,target:"_blank",rel:"noopener noreferrer",className:"text-sky-600 dark:text-sky-400 hover:underline hover:text-sky-800 dark:hover:text-sky-300",children:t.web.title||t.web.uri})},s):null)})]}),e.jsx("button",{onClick:ne,className:"mt-6 bg-slate-200 hover:bg-slate-300 text-slate-700 dark:bg-slate-600 dark:hover:bg-slate-500 dark:text-slate-200 font-semibold py-2.5 px-6 rounded-lg shadow hover:shadow-md transition-all",children:"Close Scanner & Return to Form"})]})}),e.jsxs(J,{isOpen:Ne,onClose:()=>{B(!1),K(null),p({ingredients:[]}),d(null)},title:U?"Edit Meal":"Create New Meal",size:"lg",children:[M&&e.jsx(G,{type:"error",message:M,onClose:()=>d(null),className:"mb-3"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"mealName",className:"block text-sm font-medium text-text-alt",children:["Meal Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"mealName",value:i.name||"",onChange:t=>p(s=>({...s,name:t.target.value})),className:h,maxLength:100})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mealDescription",className:"block text-sm font-medium text-text-alt",children:"Description (optional)"}),e.jsx("input",{type:"text",id:"mealDescription",value:i.description||"",onChange:t=>p(s=>({...s,description:t.target.value})),className:h,maxLength:200})]}),e.jsx("h3",{className:"text-md font-semibold text-text-default pt-2 border-t border-border-default",children:"Ingredients"}),i.ingredients&&i.ingredients.map((t,s)=>e.jsxs("div",{className:"flex items-end gap-2 p-2 border border-border-default rounded",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("label",{className:"text-xs text-text-alt",children:["Food Item ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.foodId,onChange:r=>oe(s,"foodId",r.target.value),className:h+" text-sm","aria-label":`Ingredient ${s+1} food item`,children:[e.jsx("option",{value:"",children:"Select Food"}),o.map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.calories," kcal",r.servingSize?` / ${r.servingSize}`:"",")"]},r.id))]})]}),e.jsxs("div",{className:"w-20",children:[e.jsxs("label",{className:"text-xs text-text-alt",children:["Servings ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:t.servings,onChange:r=>oe(s,"servings",r.target.value),className:h+" text-sm",step:"0.1",min:"0.1","aria-label":`Ingredient ${s+1} servings`})]}),e.jsx("button",{onClick:()=>_e(s),className:$e+" mb-1","aria-label":`Remove ingredient ${s+1}`,children:e.jsx("i",{className:"fas fa-times"})})]},s)),e.jsxs("button",{onClick:Le,className:"text-sm text-teal-600 hover:text-teal-700 dark:text-teal-400 dark:hover:text-teal-300",children:[e.jsx("i",{className:"fas fa-plus mr-1"}),"Add Ingredient"]}),o.length===0&&e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"You need to add foods to 'My Foods' first to create meals."}),e.jsx("button",{onClick:Ee,className:v+" w-full mt-4",disabled:o.length===0&&(!i.ingredients||i.ingredients.length===0),children:U?"Save Changes":"Create Meal"})]})]})]})};export{et as default};
