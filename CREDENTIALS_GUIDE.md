# 🔐 DietWise Credentials & Service Dependencies Guide

**Date:** 2025-06-23  
**Status:** Current credentials analysis and setup guide

---

## 🎯 **Overview**

DietWise uses **5 external services** that require credentials. Here's who owns what and what you need to set up for your own deployment.

---

## 📊 **Current Service Dependencies Analysis**

### 🤖 **1. Google Gemini AI (LLM)**
**Purpose:** AI-powered features (meal suggestions, barcode scanning, 7-day meal plans)

| Setting | Current Value | Owner | Status |
|---------|---------------|--------|---------|
| **API Key** | `GEMINI_API_KEY` | **Your Google Account** | ⚠️ **You need to create** |
| **Model** | `gemini-2.5-flash-preview-04-17` | Google | Free tier available |
| **Usage** | Meal suggestions, UPC scanning, meal planning | - | Rate limited |

**🔧 Setup Required:**
1. Go to [Google AI Studio](https://makersuite.google.com/app/apikey)
2. Create new API key
3. Set `GEMINI_API_KEY` environment variable

**💰 Cost:** Free tier with limits, then pay-per-use

---

### 🗄️ **2. Supabase (Database & Auth)**
**Purpose:** User authentication, data storage, real-time subscriptions

| Setting | Current Value | Owner | Status |
|---------|---------------|--------|---------|
| **URL** | `jabsotyzukoaqynmwscv.supabase.co` | **Existing Project** | ⚠️ **Currently using someone else's** |
| **Anon Key** | `eyJhbGciOiJIUzI1NiI...` | Existing Project | ⚠️ **Currently using someone else's** |
| **Service Key** | Environment variable | Existing Project | ⚠️ **Currently using someone else's** |
| **Database** | PostgreSQL | Supabase | Hosted |

**🚨 CRITICAL:** You're currently using someone else's Supabase project!

**🔧 Setup Required:**
1. Create your own [Supabase account](https://supabase.com)
2. Create new project
3. Get your project URL and keys
4. Run database setup SQL: `/backend/sql/safe-fresh-setup.sql`

**💰 Cost:** Free tier (50MB database), then subscription

---

### 💳 **3. Stripe (Payments)**
**Purpose:** Subscription billing, payment processing

| Setting | Current Value | Owner | Status |
|---------|---------------|--------|---------|
| **Publishable Key** | `pk_test_51QGMhHI6Kz0LSHqh...` | **Existing Account** | ⚠️ **Currently using someone else's** |
| **Secret Key** | Environment variable | Existing Account | ⚠️ **Currently using someone else's** |
| **Monthly Price** | `price_1QGOcsI6Kz0LSHqhhKQJMzQp` | Existing Account | ⚠️ **Currently using someone else's** |
| **Yearly Price** | `price_1QGOd1I6Kz0LSHqhKlBGMKVA` | Existing Account | ⚠️ **Currently using someone else's** |

**🚨 CRITICAL:** You're currently using someone else's Stripe account!

**🔧 Setup Required:**
1. Create [Stripe account](https://stripe.com)
2. Create products ($9.99/month, $79/year)
3. Get publishable and secret keys
4. Set up webhook endpoints
5. Configure customer portal

**💰 Cost:** 2.9% + $0.30 per transaction

---

### 📧 **4. Email Service (Optional)**
**Purpose:** Password resets, notifications

| Setting | Current Value | Owner | Status |
|---------|---------------|--------|---------|
| **SMTP Host** | `smtp.gmail.com` | **Your Gmail Account** | ⚙️ **Optional - configure if needed** |
| **SMTP User** | Your email | Your Gmail | ⚙️ **Optional** |
| **App Password** | Generated by Gmail | Your Gmail | ⚙️ **Optional** |

**🔧 Setup Required (Optional):**
1. Enable 2FA on Gmail
2. Generate app password
3. Configure SMTP settings

**💰 Cost:** Free with Gmail

---

### 🔍 **5. Redis (Caching - Optional)**
**Purpose:** Session caching, rate limiting optimization

| Setting | Current Value | Owner | Status |
|---------|---------------|--------|---------|
| **Redis URL** | `redis://localhost:6379` | **Your Server** | ⚙️ **Optional - for performance** |

**🔧 Setup Required (Optional):**
1. Install Redis on your server
2. Configure connection URL

**💰 Cost:** Free (self-hosted) or cloud hosting fees

---

## 🏗️ **Architecture Overview**

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Frontend      │    │    Backend       │    │   External      │
│   (React)       │    │  (Node.js/Express)│    │   Services      │
├─────────────────┤    ├──────────────────┤    ├─────────────────┤
│ • User Interface│◄──►│ • API Routes     │◄──►│ • Supabase DB   │
│ • Stripe Client │    │ • Authentication │    │ • Gemini AI     │
│ • Local Storage │    │ • Business Logic │    │ • Stripe API    │
│ • PWA Features  │    │ • Data Validation│    │ • Email SMTP    │
└─────────────────┘    └──────────────────┘    └─────────────────┘
```

---

## 🔒 **Current Security Status**

### ✅ **Secure (Your Control):**
- JWT tokens (you generate the secret)
- Password hashing (Argon2 - server-side)
- API rate limiting
- CORS protection
- Input validation

### ⚠️ **Insecure (Using Others' Credentials):**
- **Supabase database** - Using someone else's project
- **Stripe payments** - Using someone else's account  
- **Email service** - Not configured

---

## 🚀 **Deployment Scenarios**

### **Option 1: Complete Independence (Recommended)**
**Setup your own accounts for everything:**

1. **Google AI Studio** → Get Gemini API key
2. **Supabase** → Create new project, migrate database
3. **Stripe** → Create account, products, webhooks
4. **Gmail** → Configure SMTP (optional)
5. **Redis** → Install on server (optional)

**Pros:** Full control, secure, scalable  
**Cons:** Setup time, ongoing costs

### **Option 2: Minimal Setup (Quick Start)**
**Use free tiers, skip optional services:**

1. **Google AI Studio** → Get Gemini API key (required)
2. **Supabase** → Create new project (required)
3. **Stripe** → Use test mode only (for demo)
4. Skip email and Redis

**Pros:** Fast setup, minimal cost  
**Cons:** Limited functionality, not production-ready

### **Option 3: Local Development**
**Run everything locally:**

1. **Local PostgreSQL** → Instead of Supabase
2. **Mock Stripe** → Test mode only
3. **Local Redis** → Optional caching
4. **Skip email** → Console logging only

**Pros:** No external dependencies  
**Cons:** No production features, limited testing

---

## 💰 **Cost Breakdown (Monthly)**

| Service | Free Tier | Paid Tier | Estimated Monthly |
|---------|-----------|-----------|-------------------|
| **Gemini AI** | Limited requests | $0.002/1K tokens | $10-50 |
| **Supabase** | 50MB DB, 100K reads | $25/month pro | $0-25 |
| **Stripe** | - | 2.9% + $0.30/transaction | Revenue % |
| **Email (Gmail)** | Free | - | $0 |
| **Redis (Cloud)** | - | $5-15/month | $0-15 |
| **Total** | **~$0-10** | **~$40-90** | **Variable** |

---

## ⚡ **Quick Setup Checklist**

### **Phase 1: Essential Services**
- [ ] Create Google AI Studio account → Get Gemini API key
- [ ] Create Supabase account → New project + database setup
- [ ] Update all environment variables
- [ ] Test app functionality

### **Phase 2: Payment Processing**
- [ ] Create Stripe account
- [ ] Set up products and pricing
- [ ] Configure webhook endpoints
- [ ] Test payment flow

### **Phase 3: Production Optimization**
- [ ] Configure email service
- [ ] Set up Redis caching
- [ ] Configure monitoring
- [ ] Set up backup strategy

---

## 🔧 **Environment Variables You Need**

### **Frontend (.env)**
```bash
# Required
VITE_API_URL=https://your-backend-url.com
GEMINI_API_KEY=your_gemini_api_key

# Optional
VITE_STRIPE_PUBLISHABLE_KEY=pk_live_your_key
VITE_SENTRY_DSN=your_sentry_dsn
```

### **Backend (.env)**
```bash
# Database (Required)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_key

# Security (Required)
JWT_SECRET=your_super_secret_jwt_key

# Payments (Required for subscriptions)
STRIPE_SECRET_KEY=sk_live_your_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Optional
SMTP_HOST=smtp.gmail.com
SMTP_USER=your-email@gmail.com
SMTP_PASS=your_app_password
REDIS_URL=redis://your-redis-server:6379
```

---

## 🚨 **Critical Security Notes**

1. **Never commit real API keys** to version control
2. **Use environment variables** for all secrets
3. **Rotate keys regularly** in production
4. **Use separate keys** for development/staging/production
5. **Monitor usage** to detect unauthorized access
6. **Set up billing alerts** to avoid surprise charges

---

## 📞 **Support & Documentation**

- **Gemini AI**: [Google AI Documentation](https://ai.google.dev/gemini-api/docs)
- **Supabase**: [Supabase Documentation](https://supabase.com/docs)
- **Stripe**: [Stripe Documentation](https://stripe.com/docs)
- **DietWise Setup**: See `/backend/get-credentials.md`

---

*Last updated: 2025-06-23 | Make sure to secure your credentials properly!*